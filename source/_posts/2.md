layout: react-native
title: 解决登录页底部的公司署名因调取键盘位置被提升问题
date: 2017-02-19 16:47:48
categories: 移动端
---
# 背景

在开发React Native时，登录页底部需要添加公司名称，当用户名或密码输入框被focus时，键盘被调取，导致公司名称的布局被提升至键盘之上。布局如下：

<!-- more -->

    <View style={_styles.wrapper}>
        <View style={_styles.header}>header(logo)</View>
        <View style={_styles.content}>content(inputs)</View>
        <Text style={_styles.footer}>footer(company name)</Text>
    </View>

    let _styles = StyleSheet.create({
        
        wrapper: {
            flex: 1
        },

        header: {
            height: 50
        },

        content: {
            flex: 1
        },

        footer: {
            height: 30,
            lineHeight: 30,
            textAlign: 'center'
        }
    });


# 问题分析

布局使用了flex方案，父元素设置为felx:1,使得其宽高沾满屏幕。而三个子节点各自分配对应的高度。当键盘被调取，屏幕上内容的可视高度变小，使得布局分配的高度压缩，导致底栏的节点被迫提升。


# 解决方案
 
方案一：
设置footer节点布局方式为固定定位(position: fixed),当检测到键盘被调取时(RN提供Keyboard组件的键盘调取方案，但是只支持原生键盘，并且只有keyboard didMount时才执行)，设置其定位为position: relative，拥有文档流特质，解决提升。
方案二：
对父节点设置最小高，当键盘调取时，最小高生效，避免提升。

    componentDidMount() {
        var {height, width} = Dimensions.get('window');
        this.minHeight = height - safeHeight(避免微小误差高度);
    }

    render() {
        return ( <View style={_styles.wrapper, {minHeight}}> code... </View>)
    }


# 方案分析

方案一所受限制较多，暂不推荐，但其思想可取。方案二相对成本较低，实现简单，容易维护，推荐使用。

